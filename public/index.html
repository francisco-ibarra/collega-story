<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes">
  
  <link rel="stylesheet" href="css/swiper.min.css">
  <link href="css/ratchet.min.css" rel="stylesheet">
  <script src="js/ratchet.min.js"></script>  
  
  <link href="css/font-awesome.min.css" rel="stylesheet">
  
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div id="app"> 
    <transition name="slide-fade">
    <router-view v-bind:session="session"></router-view>
    </transition>
  </div>
   

  <script id="page-home" type="text/x-template"> 
    <div class="content"> 
      <header class="bar bar-nav">
        <h1 class="title">Storygram</h1>
        <button v-on:click="goTo('logout')" class="btn btn-link btn-nav pull-right">
          Logout
        </button>        
        
      </header>
      <div class="content home"> 
        <!-- CARD.BEGIN -->
        
        <div class="cover">
          <img v-bind:src="profile.cover_picture">
          
        </div>
        <div class="spring">
          <div class="profile">
            <img class="img-circle" v-bind:src="profile.profile_picture">
            <h2>{{profile.full_name}}</h2>
            <p> Last session yesterday 4pm </p>
          </div>
          
          
          
          <div class="grid grid-big">
            <!--form class="home"-->              
              
              <div class="grid-item grid-item-center">
                <div v-on:click="goTo('photos')" class="img-circle"><img src="img/photos.png">
                </div>
                <span>Photos</span>
              </div>
              
              <div class="grid-item grid-item-center">
                <div v-on:click="goTo('stories')" class="img-circle"><img src="img/stories.png">
                </div>
                <span>Stories</span>
              </div>      
              
              <div class="grid-item grid-item-center">
                <div v-on:click="goTo('social')" class="img-circle"><img src="img/social.png">
                </div>
                <span>Social</span>
              </div>    
                                        
              <div class="grid-item grid-item-center">
                <div class="img-circle"><img src="img/discover.png">
                </div>
                <span>Collegamenti</span>
              </div>    
              
              <!--button class="btn btn-primary btn-outlined btn-block" v-on:click="goTo('photos')">Photos</button>      
              <button class="btn btn-primary btn-outlined btn-block" 
              v-on:click="goTo('stories')">Stories</button>  
              <button class="btn btn-primary btn-outlined btn-block"
              v-on:click="goTo('social')">
              Social</button>
              <button disabled class="btn btn-outlined btn-block">
              Discover</button-->            
   
            <!--/form-->
          </div>
        </div>
        <!-- CARD.END -->
      </div>
    </div>
  </script>
  
  <script id="page-login" type="text/x-template">

        <div class="content login"> 
          <!-- CARD.BEGIN -->
          <img class="logo" src="img/logo_big.png">
          <div class="card">
            <div class="content-padded">
              <form>
                <input type="text" v-model="username" placeholder="Instagram username">
                <input type="password" v-model="password" placeholder="Fake password, doens't matter">

                <button class="btn btn-primary btn-outlined btn-block" v-on:click.prevent="login">Sign in</button>       

              </form>
            </div>
          </div>
          <!-- CARD.END -->
        </div>  
  </script>
  
  <!-- TODO: move to vue files -->
  <script id="photo-slide" type="text/x-template">
             
    <div class="slideshow swiper-container">
        <div class="swiper-wrapper">
          <div class="swiper-slide" v-for="photo in photos" v-on:click="toggleControls">
          <img v-bind:src="photo.images.standard">
          </div>            
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>

        <a v-on:click.stop="goBack" class="slide-close">
          <span class="icon icon-close"></span>
        </a>

        <ul class="photo-controls">
          <li v-on:click="toggleCurrentControl('tag')">
           <a><span class="icon icon-person"></span></a> 
           </li>
          <li v-if="showStory" v-on:click="toggleCurrentControl('story')">
           <a><span class="icon icon-edit"></span></a>
           </li>           
        </ul>   

        <div class="tagControls photo-cards modal" v-bind:class="{active : tagControlOn}">

          <!-- slider begin -->
          <div class="swiper-wrapper">
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <!-- summary shown only when not active -->
                  <div class="summary">
                    <h2>Where was this photo taken?</h2>
                    <p>{{activePhoto.place}}</p>
                  </div>
                  <!-- form shown only when active -->
                  <form>
                    <h2>Where was this photo taken?</h2>
                    <textarea v-model="activePhoto.place" rows="5" placeholder="e.g., Trento, Italy"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Don't remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <div class="summary">
                    <h2>When was this photo taken?</h2>
                    <p>{{activePhoto.date}}</p>
                  </div>
                  <form>
                    <h2>When was this photo taken?</h2>
                    <textarea v-model="activePhoto.date" rows="5" placeholder="Insert exact or approximate date"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Don't remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <div class="summary">
                    <h2>Who's in the photo?</h2>
                    <p>{{activePhoto.people}}</p>
                  </div>
                  <form>
                    <h2>Who's in the photo?</h2>
                    <textarea v-model="activePhoto.people" rows="5" placeholder="e.g., Trento, Italy"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Does not remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
          </div>
          <!-- slider end -->
        </div>

        <div class="photo-cards modal" v-bind:class="{active : storyControlOn}">

          <!-- slider begin -->
          <div class="swiper-wrapper">
            <div class="swiper-slide swiper-slide-active">
              <div class="card">
                <div class="content-padded">
                  <!-- summary shown only when not active -->
                  <div class="summary">
                    <h2>Tell us a story about this picture</h2>
                  </div>
                  <!-- form shown only when active -->
                  <form>
                    <h2>Tell us a story about this picture</h2>
                    <textarea v-model="activePhoto.story" rows="5" placeholder=""></textarea>
                    <button v-on:click.stop="onStorySave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
          </div>
          <!-- slider end -->
        </div>                                                                

    </div>                
   
  </script>
  
  <script id="photo-grid" type="text/x-template">
    <div class="content"> 
      <header class="bar bar-nav">
        <router-link v-bind:to="{name : 'home'}" class="btn btn-link btn-nav pull-left">
          <span class="icon icon-left-nav"></span>
          Home
        </router-link>  
        <button class="btn btn-link btn-nav pull-right">
          <span class="icon icon-plus"></span>
          Add photos
        </button>
        <!--button class="btn btn-link btn-nav pull-right">
          <span class="icon icon-play"></span>
          Tag photos
        </button-->
        <h1 class="title">Photos</h1>                        
      </header>
      
      <nav class="bar bar-standard bar-header-secondary">
        <div class="segmented-control">
          <a class="control-item active">Last imported</a>
          <a class="control-item">Timeline</a>
          <a class="control-item">Collaborator</a>
        </div>
      </nav>      
      
      <div class="content">
          <div class="grid">
            <div class="grid-item" v-for="(photo, index) in photos">
              <div class="tile" v-on:click="openSlideShow(index)">
                <img v-bind:src="photo.images.standard">
                <!--div class="tile-caption">
                photo.caption.text
                </div-->
                <div class="tile-contributor">
                    <img class="img-circle" v-bind:src="photo.contributor.profile_picture">                                        
                    <span>Posted by {{photo.contributor.full_name.split(" ")[0]}}</span>
                </div>
                <div class="tile-meta content-padded">

                    
                    <a class="meta-item" v-bind:class="{ 'tag-false': photo.tags.place == '' }">
                      <i class="fa fa-map-o"></i>
                      <span class="item-label">PLACE</span>
                    </a>  
                  
                    <a class="meta-item" v-bind:class="{ 'tag-false': photo.tags.date == '' }">
                      <i class="fa fa-calendar-check-o"></i>
                      <span class="item-label">DATE</span>
                    </a>                    
                    
                    <a class="meta-item" v-bind:class="{ 'tag-false': photo.tags.people.length === 0 }">
                      <i class="fa fa-user-o"></i>
                      <span class="item-label">PEOPLE</span>
                    </a>


                </div>
              </div>
            </div>  
          </div>
      </div>
      
    </div>   
  </script>
 
  <script id="story-grid" type="text/x-template">
    <div class="content"> 
      <header class="bar bar-nav">
        <router-link v-bind:to="{name : 'home'}" class="btn btn-link btn-nav pull-left">
          <span class="icon icon-left-nav"></span>
          Home
        </router-link>
        <router-link :to="{name: 'stories', query: {create : 'select'}}" class="btn btn-link btn-nav pull-right">
          <span class="icon icon-plus"></span>
          Create story
        </router-link>
        <h1 class="title">Stories</h1>                        
      </header>
      
      <div class="content">
            <div class="grid stories">
              <div class="grid-item" v-for="(story, index) in stories">
                <!--[ tile -->
                <div class="tile" v-on:click="openSlideShow(index)">
                    <img v-bind:src="story.photo.images.standard">
                    <div class="tile-caption">
                      {{story.story}}
                    </div>
                    <div class="tile-meta content-padded">
                      <span class="pull-left">
                        <img class="tile-profile" v-bind:src="story.from.profile_picture">
                        
                      </span>
                      <span class="pull-right"> 
                      {{story.from.full_name}}<br>
                      {{ago(story.created_time)}}
                      </span>
                    </div>  
                </div>
                <!-- tile ]-->
              </div>  
            </div>
      </div>      
      
      
    </div>
  </script>  
  
  <script id="story-photo-select" type="text/x-template">
    <div class="content"> 
      <header class="bar bar-nav">
        <router-link :to="{name: 'stories', query : {}}" class="btn btn-link btn-nav pull-right">
          <span class="icon icon-close"></span>
          Cancel
        </router-link>
        <h1 class="title">Create story</h1>               
      </header>
      
      <div class="bar bar-standard bar-header-secondary">
        <div class="content-padded">
          <h4>Before starting, select the photos for the
           reminiscing session
           </h4>
        </div>
      </div>
      
      <div class="content">
          <div class="grid">
            <div class="grid-item" v-for="(photo, index) in photos">
              <div class="tile" v-on:click="selectCurrent(index)">
                <img v-bind:src="photo.images.standard">
                <span v-if="photo.selected" class="icon icon-check"></span>
              </div>              
            </div>              
          </div>        
        
      </div>      
      
      <div class="bar bar-standard bar-footer">
        <router-link :to="{name: 'stories', query : {create : 'start', showStory : true}}"
        class="btn btn-block btn-primary btn-outlined">
        Start session</router-link>
      </div>      
      
    </div>  
  </script>
   
  <!-- TODO: move to vue files -->
  <script id="story-slide" type="text/x-template">
             
    <div class="slideshow swiper-container">
        <div class="swiper-wrapper">
          <div class="swiper-slide" v-for="photo in photos" v-on:click="toggleControls">
          <img v-bind:src="photo.images.standard">
          <p>{{photo.tags.story}}</p>
          </div>            
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
        
        

        <a v-on:click.stop="goBack" class="slide-close">
          <span class="icon icon-close"></span>
        </a>

        <ul class="photo-controls">
          <li v-on:click="toggleCurrentControl('tag')">
           <a><span class="icon icon-person"></span></a> 
           </li>
          <li v-if="showStory" v-on:click="toggleCurrentControl('story')">
           <a><span class="icon icon-edit"></span></a>
           </li>           
        </ul>   

        <div class="tagControls photo-cards modal" v-bind:class="{active : tagControlOn}">

          <!-- slider begin -->
          <div class="swiper-wrapper">
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <!-- summary shown only when not active -->
                  <div class="summary">
                    <h2>Where was this photo taken?</h2>
                    <p>{{activePhoto.place}}</p>
                  </div>
                  <!-- form shown only when active -->
                  <form>
                    <h2>Where was this photo taken?</h2>
                    <textarea v-model="activePhoto.place" rows="5" placeholder="e.g., Trento, Italy"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Don't remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <div class="summary">
                    <h2>When was this photo taken?</h2>
                    <p>{{activePhoto.date}}</p>
                  </div>
                  <form>
                    <h2>When was this photo taken?</h2>
                    <textarea v-model="activePhoto.date" rows="5" placeholder="Insert exact or approximate date"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Don't remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
            <div class="swiper-slide">
              <div class="card" v-on:click="activateCard">
                <div class="content-padded">
                  <div class="summary">
                    <h2>Who's in the photo?</h2>
                    <p>{{activePhoto.people}}</p>
                  </div>
                  <form>
                    <h2>Who's in the photo?</h2>
                    <textarea v-model="activePhoto.people" rows="5" placeholder="e.g., Trento, Italy"></textarea>
                    <button v-on:click.stop="nextCard" class="btn btn-block">Does not remember</button>
                    <button v-on:click.stop="onTagSave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
          </div>
          <!-- slider end -->
        </div>

        <div class="photo-cards modal" v-bind:class="{active : storyControlOn}">

          <!-- slider begin -->
          <div class="swiper-wrapper">
            <div class="swiper-slide swiper-slide-active">
              <div class="card">
                <div class="content-padded">
                  <!-- summary shown only when not active -->
                  <div class="summary">
                    <h2>Tell us a story about this picture</h2>
                  </div>
                  <!-- form shown only when active -->
                  <form>
                    <h2>Tell us a story about this picture</h2>
                    <textarea v-model="activePhoto.story" rows="5" placeholder=""></textarea>
                    <button v-on:click.stop="onStorySave" class="btn btn-primary btn-block">Save</button </form>
                </div>
              </div>
            </div>
          </div>
          <!-- slider end -->
        </div>                                                                

    </div>                
   
  </script>   
   
 
  <script id="social-grid" type="text/x-template">
    <div class="content"> 
      <header class="bar bar-nav">
        <router-link v-bind:to="{name : 'home'}" class="btn btn-link btn-nav pull-left">
          <span class="icon icon-left-nav"></span>
          Home
        </router-link>  
        <button class="btn btn-link btn-nav pull-right">
          <span class="icon icon-play"></span>
          Play messages
        </button>
        <h1 class="title">Social</h1>                        
      </header>
      
      <nav class="bar bar-standard bar-header-secondary">
        <div class="segmented-control">
          <a class="control-item active">Your updates</a>
          <a class="control-item">Updates from friends</a>
        </div>
      </nav>   
      
      <div class="content">
          <div class="grid grid-big">
            <div class="grid-item" v-for="(item, index) in feedback">
              <div class="tile tile-telegram tile-horizontal" v-on:click="openSlideShow(index)">
 
                   
                    <div class="tile-item tile-photo-wrapper">
                      <img class="tile-photo" v-bind:src="item.story.photo.images.standard">  
                    </div>

                    <div class="tile-item tile-center">                    
                      <div class="tile-message" v-if="item.type == 'comment'">
                        <div><h2>Message</h2></div>
                        <div class="msg">
                          <span>
                          {{ item.data.text.length > 200? 
                            item.data.text.substring(0,200) + "...":
                            item.data.text }}
                          </span>
                        </div>                      
                        <div>
                          <img class="img-circle tile-profile" v-bind:src="item.data.from.profile_picture">
                          <span>{{item.data.from.full_name}}</span>
                        </div>
                      </div>

                      <div class="tile-message" v-if="item.type == 'like'">         <div><h2>Message</h2></div>            
                        <div class="msg">
                          <span class="icon icon-star"></span>
                          <span>I Liked your story! </span>                        
                        </div>
                        <div>
                          <img  class="img-circle tile-profile" v-bind:src="item.data.profile_picture">
                          <span>{{item.data.full_name}}</span>
                        </div>
                      </div>  
                    </div>                

                
              </div>
            </div>  
          </div>
      </div>      
      
      
    </div>  
  </script>
     
   
<script id="social-slide" type="text/x-template">
             
<div class="slideshow swiper-container">
  <div class="swiper-wrapper">
    <div class="swiper-slide" v-for="item in feedback">
      <img v-bind:src="item.story.photo.images.standard">
      <!--p>{{item.story.story}} </p-->

        <p class="msg" v-if="item.type == 'comment'">
          From {{item.data.from.full_name}}: 
                <span>
                {{ item.data.text.length > 200? 
                  item.data.text.substring(0,200) + "...":
                  item.data.text }}
                </span>
              
        </p>

      <p class="msg" v-if="item.type == 'like'">       
          <span>{{item.data.full_name}} really liked it!</span>
      </p>
      

    </div>


  </div>
  <!-- Add Pagination -->
  <div class="swiper-pagination"></div>



  <a v-on:click.stop="goBack" class="slide-close">
    <span class="icon icon-close"></span>
  </a>


</div> 
                  
   
  </script>      
   
   

  
<script src="js/swiper.min.js"></script>  
<script src="js/axios.min.js"></script>
<script src="js/vue.min.js"></script>
<script src="js/vue-router.min.js"></script>
<script src="js/moment.min.js"></script>

<script src="js/bundle.js"></script>

</body>

</html>
